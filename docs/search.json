[{"path":"https://419kfj.github.io/futools/articles/How_to_use_mosaic.html","id":"本稿の目的","dir":"Articles","previous_headings":"","what":"本稿の目的","title":"How to use vcd::mosaic","text":"vcd::mosaicを使う際のtipsを整理する","code":""},{"path":[]},{"path":"https://419kfj.github.io/futools/articles/How_to_use_mosaic.html","id":"mosaic-plotとはなにか","dir":"Articles","previous_headings":"vcd::mosaic とはなにか","what":"mosaic plotとはなにか","title":"How to use vcd::mosaic","text":"mosaic plotは、帯棒グラフの拡張版と理解できる。帯棒グラフでは、nの値がことなる「棒」であっても、棒の高さが同じに表示されるために、全体の分布の中での評価をあやまることがある。mosaic plotは、セルの面積で度数を表現するので、n= がグラフ表現の中に組み込まれた「帯棒グラフ」を考えることできる。 CRANに登録されているpackgeのDESCRIPTION Description Visualization techniques, data sets, summary inference procedures aimed particularly categorical data. Special emphasis given highly extensible grid graphics. package package originally inspired book Visualizing Categorical Data'' Michael Friendly now main support package new book,Discrete Data Analysis R’’ Michael Friendly David Meyer (2015).","code":""},{"path":"https://419kfj.github.io/futools/articles/How_to_use_mosaic.html","id":"basemosaicplot-との違いはなにか","dir":"Articles","previous_headings":"vcd::mosaic とはなにか","what":"base::mosaicplot との違いはなにか","title":"How to use vcd::mosaic","text":"baseにもmosaicplotがある。しかし、入力された表tableの行と列の位置が逆になっている。加えて、vcd::mosaicには、以下に述べる機能的な特徴がある。","code":""},{"path":"https://419kfj.github.io/futools/articles/How_to_use_mosaic.html","id":"ggplot2のggmosaicとの違いはなにか","dir":"Articles","previous_headings":"vcd::mosaic とはなにか","what":"ggplot2のggmosaicとの違いはなにか","title":"How to use vcd::mosaic","text":"ggmosaicは、表のグラフ表示をggplotベースで実現したものである。","code":""},{"path":"https://419kfj.github.io/futools/articles/How_to_use_mosaic.html","id":"vcdmosaic-の表の表示以上の機能","dir":"Articles","previous_headings":"vcd::mosaic とはなにか","what":"vcd::mosaic の「表の表示」以上の機能","title":"How to use vcd::mosaic","text":"残差表示 対数線形モデルでのモデルごとのfittingの表示","code":""},{"path":[]},{"path":"https://419kfj.github.io/futools/articles/How_to_use_mosaic.html","id":"install","dir":"Articles","previous_headings":"vcd::mosaicの使い方","what":"install","title":"How to use vcd::mosaic","text":"Package タブでvcdのインストールを行い、.Rや.Rmdでは、library(vcd)を実行。 関連するものとして、vcdExtra、そして、必要であれば、日本語データや、設定パラメータを用意してあるfutoolsもインストールしておく。 futooltsで提供している、HairEyeColor_jp、HairEyeColor_krは、それぞれ表のカテゴリラベルを日本語、韓国語にしたものである。","code":"data(\"HairEyeColor\") # 髪の色と目の色の対応関係を集計した３元クロス表 HairEyeColor #> , , Sex = Male #>  #>        Eye #> Hair    Brown Blue Hazel Green #>   Black    32   11    10     3 #>   Brown    53   50    25    15 #>   Red      10   10     7     7 #>   Blond     3   30     5     8 #>  #> , , Sex = Female #>  #>        Eye #> Hair    Brown Blue Hazel Green #>   Black    36    9     5     2 #>   Brown    66   34    29    14 #>   Red      16    7     7     7 #>   Blond     4   64     5     8 ftable(HairEyeColor,row.vars = c(\"Sex\",\"Hair\")) #>              Eye Brown Blue Hazel Green #> Sex    Hair                             #> Male   Black        32   11    10     3 #>        Brown        53   50    25    15 #>        Red          10   10     7     7 #>        Blond         3   30     5     8 #> Female Black        36    9     5     2 #>        Brown        66   34    29    14 #>        Red          16    7     7     7 #>        Blond         4   64     5     8"},{"path":[]},{"path":"https://419kfj.github.io/futools/articles/How_to_use_mosaic.html","id":"haireyecolor-を表示する","dir":"Articles","previous_headings":"vcd::mosaicの基本形","what":"HairEyeColor を表示する","title":"How to use vcd::mosaic","text":"","code":"HairEyeColor %>% mosaic()"},{"path":"https://419kfj.github.io/futools/articles/How_to_use_mosaic.html","id":"標準化残差を表示する","dir":"Articles","previous_headings":"vcd::mosaicの基本形","what":"標準化残差を表示する","title":"How to use vcd::mosaic","text":"","code":"HairEyeColor %>% mosaic(shade = TRUE)"},{"path":"https://419kfj.github.io/futools/articles/How_to_use_mosaic.html","id":"性別のラベルが重なってしまっているので90度回転する","dir":"Articles","previous_headings":"vcd::mosaicの基本形","what":"「性別」のラベルが重なってしまっているので、90度回転する","title":"How to use vcd::mosaic","text":"maegin設定はのちほど。 ##　性別ごとに髪の色と目の色の対応を表示する","code":"HairEyeColor %>% mosaic(rot_labels = c(left = 0, top = 0, right = 0),) HairEyeColor %>% mosaic(Eye ~ Sex + Hair,.,                         rot_labels = c(left = 0, top = 0, right = 0))"},{"path":[]},{"path":"https://419kfj.github.io/futools/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"package maintainer. Maintainer.","code":""},{"path":"https://419kfj.github.io/futools/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"fujimoto k (2025). futools: vcd::mosaic Japanese wrapper. R package version 0.1.3.3, https://419kfj.github.io/futools/.","code":"@Manual{,   title = {futools: vcd::mosaic Japanese wrapper},   author = {kazuo fujimoto},   year = {2025},   note = {R package version 0.1.3.3},   url = {https://419kfj.github.io/futools/}, }"},{"path":"https://419kfj.github.io/futools/index.html","id":"futools","dir":"","previous_headings":"","what":"vcd::mosaic Japanese wrapper","title":"vcd::mosaic Japanese wrapper","text":"このPackageは、vcdが提供するmosaic などのグラフ生成ツールで日本語を使えるようにするものです。 カテゴリカルデータの可視化には、Michael Friendly先生たちのvcd（その名もずばり、Visualizing Categorical Data：カテゴリカルデータの可視化）が有効なことはいろいろなところでこのパッケージが紹介されていることからもわかります。ただ、グラフィックがbase graphics ではなく、（latticeやggplot2でも使われている）gridであることもあり、日本語表示が簡単ではありませんでした。 しかし、gpar に日本語フォントを指定することでmosaicなどのvcd function で日本語がつかえるようになります。 grid graphics であるvcdで日本語を使うには、package showtextをインストールし、library(showtext)ののり、showtext_auto(TRUE)を設定すればOKです。ggplot2 でも有効です。 こうした経緯があるために、以前、以下のように書いてましたが、 「当初は、一々mosaic()の中にパラメータで書いていたのですが、さすがに面倒になったので、wrapper をパッケージにしてみました。」 showtextを使えば日本語（以外もOK）表示のために、いちいちgparを指定しなくてもいいので、このwraperは、mosaiの使い方の説明になりました。 Github からインストールできますので、使ってみてください。","code":""},{"path":"https://419kfj.github.io/futools/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"vcd::mosaic Japanese wrapper","text":"githubから以下のようにしてインストールできます：","code":"if (!require(devtools)){     install.packages('devtools')     library(devtools) } devtools::install_github(\"419kfj/futools\")"},{"path":"https://419kfj.github.io/futools/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"vcd::mosaic Japanese wrapper","text":"basic example shows solve common problem:","code":"library(vcd) ## 要求されたパッケージ grid をロード中です library(RColorBrewer) library(futools) library(showtext) ## 要求されたパッケージ sysfonts をロード中です  ## 要求されたパッケージ showtextdb をロード中です showtext_auto(TRUE)  # data set data(HairEyeColor_jp)  mosaic(HairEyeColor,shade = TRUE) # plain mosaic_jp mosaic_jp(HairEyeColor_jp) # without cell color mosaic_jp2(HairEyeColor_jp) # set cell color by color matrix cset <- t(matrix(rep(brewer.pal(4,\"Blues\"),2),ncol=2)) mosaic_jp2(HairEyeColor_jp,gp=gpar(fill=cset,col=0)) # Pearson residulas mosaic_jp2(HairEyeColor_jp,shade=TRUE)"},{"path":"https://419kfj.github.io/futools/index.html","id":"参考文献","dir":"","previous_headings":"","what":"参考文献","title":"vcd::mosaic Japanese wrapper","text":"藤本一男,2017, 「二つのmosaic plotと日本語表示」★日本語表示の箇所は↑で読み替えてください。 https://www.slideshare.net/kazuofujimoto/2mosaic-plot-80084536 藤本一男,2017, 「vcd/vcdExtra で日本語を使う その2」 https://www.slideshare.net/kazuofujimoto/use-japanese--vcdvcdextra-package David Meyer, Achim Zeileis, Kurt Hornik , 2007, Strucplot Framework: Visualizing Multi-way Contingency Tables vcd, Journal Statistical Software,Vol17, https://www.jstatsoft.org/index.php/jss/article/view/v017i03/v17i03.pdf http://euclid.psych.yorku.ca/datavis.ca/courses/VCD/vcd-tutorial.pdf https://www.datavis.ca/courses/VCD/vcd-tutorial.pdf Zach Bogart, Joyce Robbins,2019, “GR5702 Exploratory Data Analysis Visualization course offered Columbia University.”,https://jtr13.github.io/EDAVold/mosaic.html","code":""},{"path":"https://419kfj.github.io/futools/reference/HairEyeColor_jp.html","id":null,"dir":"Reference","previous_headings":"","what":"日本語化した HairEyeColor データ — HairEyeColor_jp","title":"日本語化した HairEyeColor データ — HairEyeColor_jp","text":"日本語化した HairEyeColor データ","code":""},{"path":"https://419kfj.github.io/futools/reference/HairEyeColor_jp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"日本語化した HairEyeColor データ — HairEyeColor_jp","text":"","code":"HairEyeColor_jp"},{"path":"https://419kfj.github.io/futools/reference/HairEyeColor_jp.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"日本語化した HairEyeColor データ — HairEyeColor_jp","text":"object class table dimension 4 x 4 x 2.","code":""},{"path":"https://419kfj.github.io/futools/reference/mosaic_jp.html","id":null,"dir":"Reference","previous_headings":"","what":"set up font for using Japanese with vcd::mosaic — mosaic_jp","title":"set up font for using Japanese with vcd::mosaic — mosaic_jp","text":"mosaic_jp*","code":""},{"path":"https://419kfj.github.io/futools/reference/mosaic_jp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"set up font for using Japanese with vcd::mosaic — mosaic_jp","text":"","code":"mosaic_jp1()"},{"path":"https://419kfj.github.io/futools/reference/mosaic_jp.html","id":"references","dir":"Reference","previous_headings":"","what":"References","title":"set up font for using Japanese with vcd::mosaic — mosaic_jp","text":"- Strucplot Framework: Visualizing Multi-way Contingency Tables vcd: https://www.jstatsoft.org/index.php/jss/article/view/v017i03/v17i03.pdf","code":""},{"path":"https://419kfj.github.io/futools/reference/mosaic_jp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"set up font for using Japanese with vcd::mosaic — mosaic_jp","text":"","code":"# installation  if(!require(devtools)) install.packages(\"devtools\") #> Loading required package: devtools #> Loading required package: usethis devtools::install_github(\"419kfj/futools\") #> Using github PAT from envvar GITHUB_PAT. Use `gitcreds::gitcreds_set()` and unset GITHUB_PAT in .Renviron (or elsewhere) if you want to use the more secure git credential store instead. #> Downloading GitHub repo 419kfj/futools@HEAD #> ── R CMD build ───────────────────────────────────────────────────────────────── #> * checking for file ‘/tmp/RtmpwRIX4k/remotes74db04505b35a/419kfj-futools-a46f34d/DESCRIPTION’ ... OK #> * preparing ‘futools’: #> * checking DESCRIPTION meta-information ... OK #> * checking for LF line-endings in source and make files and shell scripts #> * checking for empty or unneeded directories #> * building ‘futools_0.1.3.3.tar.gz’ #>  #> Installing package into ‘/tmp/RtmpB5SyjU/temp_libpath7377e2d752e11’ #> (as ‘lib’ is unspecified)  # data set data(HairEyeColor_jp)  # plain mosaic_jp mosaic_jp0(HairEyeColor_jp) #> Error in mosaic_jp0(HairEyeColor_jp): could not find function \"mosaic_jp0\"  # without cell color mosaic_jp2(HairEyeColor_jp) #> Error in mosaic(.tbl, ..., margins = c(left = 5, top = 4), rot_labels = c(left = 0,     top = 45, right = 0), keep_aspect_ratio = FALSE, main = mtitle,     labeling = labeling_values): could not find function \"mosaic\"  # set cell color by color matrix cset <- t(matrix(rep(brewer.pal(4,\"Blues\"),2),ncol=2)) #> Error in brewer.pal(4, \"Blues\"): could not find function \"brewer.pal\" mosaic_jp2(HairEyeColor_jp,gp=gpar(fill=cset,col=0)) #> Error in mosaic(.tbl, ..., margins = c(left = 5, top = 4), rot_labels = c(left = 0,     top = 45, right = 0), keep_aspect_ratio = FALSE, main = mtitle,     labeling = labeling_values): could not find function \"mosaic\"  # Pearson residulas mosaic_jp2(HairEyeColor_jp,shade=TRUE) #> Error in mosaic(.tbl, ..., margins = c(left = 5, top = 4), rot_labels = c(left = 0,     top = 45, right = 0), keep_aspect_ratio = FALSE, main = mtitle,     labeling = labeling_values): could not find function \"mosaic\""},{"path":"https://419kfj.github.io/futools/reference/mosaic_jp1.html","id":null,"dir":"Reference","previous_headings":"","what":"colset is the col name of RColorbrewer ex: ","title":"colset is the col name of RColorbrewer ex: ","text":"colset col name RColorbrewer ex: \"Pastel1\", \"Blues\" library(RColorBrewer) display.brewer.(n=10, exact.n=FALSE) # can see color palette","code":""},{"path":"https://419kfj.github.io/futools/reference/mosaic_jp1.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"colset is the col name of RColorbrewer ex: ","text":"","code":"mosaic_jp1(.tbl, mtitle = \"mosaic_jp\", colset = \"Set3\")"},{"path":"https://419kfj.github.io/futools/reference/mosaic_jp1cell.html","id":null,"dir":"Reference","previous_headings":"","what":"このあと、 labeling_cells(text = round(100*prop.table(.tbl,1),1))(.tbl) のように表示するデータを指示する。 — mosaic_jp1cell","title":"このあと、 labeling_cells(text = round(100*prop.table(.tbl,1),1))(.tbl) のように表示するデータを指示する。 — mosaic_jp1cell","text":"このあと、 labeling_cells(text = round(100*prop.table(.tbl,1),1))(.tbl)　のように表示するデータを指示する。","code":""},{"path":"https://419kfj.github.io/futools/reference/mosaic_jp1cell.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"このあと、 labeling_cells(text = round(100*prop.table(.tbl,1),1))(.tbl) のように表示するデータを指示する。 — mosaic_jp1cell","text":"","code":"mosaic_jp1cell(.tbl, mtitle = \"mosaic_jp\", colset = \"Set3\")"}]
